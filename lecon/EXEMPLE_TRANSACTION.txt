
package localhost.test;
import com.mysql.cj.MysqlType;
import java.sql.Connection;


import java.sql.*;
import java.util.Scanner;

/**
 *
 * @author RAZAFIMAHATRATRA
 */
public class JDBCMain 
{
    
     
    public static void main(String[] args) throws SQLException 
    {
        
        String dbHost = "jdbc:mysql://localhost:3306/employees";
        String dbUser = "root";
        String dbPasswd ="";
        Connection c = null;
        CallableStatement cStmt = null;
        PreparedStatement pStmt = null;
        String cDept;
        String lDept;
        Integer choix = 0;
        Scanner sc = new Scanner(System.in);
        
       
        // ETAPE 1 : etablir  connection
        c = DriverManager.getConnection(dbHost,dbUser ,dbPasswd );
        c.setAutoCommit(false);
        System.out.println("Connexion etablie");
      
        // ETAPE 2 : PREPARER LA STATEMENT
      pStmt = c.prepareStatement("INSERT INTO DEPARTMENTS VALUES(?,?)");
      System.out.println("Saisir le code du dept : ");
      cDept = sc .nextLine();
      System.out.println("Saisir le nom du dept : ");
      lDept = sc .nextLine();
       
        // ETAPE 3 : SET DES PARAMETRE
        
        pStmt.setString(1,cDept);
         pStmt.setString(2,lDept);
          
             
          
        // ETAPE 4 : EXECUTER LE STATEMENT
        System.out.println("----- Execution de la requete -----");
        pStmt.executeUpdate();
        System.out.println("Taper 1 si vous voulez valider les changements 0 si non");
        choix =sc.nextInt();
        if(choix==1){
            c.commit();
        }
        else{
            c.rollback();
        }

        
                   
     
    }
         
}
