
package localhost.test;
import com.mysql.cj.MysqlType;
import java.sql.Connection;


import java.sql.*;

/**
 *
 * @author RAZAFIMAHATRATRA
 */
public class JDBCMain 
{
    
     
    public static void main(String[] args) throws SQLException 
    {
        
        String dbHost = "jdbc:mysql://localhost:3306/employees";
        String dbUser = "root";
        String dbPasswd ="";
        Connection c = null;
        CallableStatement cStmt = null;
        
       
        // ETAPE 1 : etablir  connection
        c = DriverManager.getConnection(dbHost,dbUser ,dbPasswd );
        System.out.println("Connexion etablie");
      
        // ETAPE 2 : PREPARER LA PROCEDURE STOCKEE
        cStmt = c.prepareCall("{Call get_emp_title(?)}");
       
     
        
        // ETAPE 3 : SET DES PARAMETRE
            // cStmt.setInt(1,10001);
            cStmt.setInt(1,10002);
           
            //cStmt.setString(1,"d001");
             
          
        // ETAPE 4 : APPEL DE LA PROCEDURE
        cStmt.execute();
        
        // ETAPE 5 : RECUPERER RESULTSET
        
        ResultSet rs = cStmt.getResultSet();
        while(rs.next()){
            System.out.println("emp code : "+rs.getInt(1)+" Title : "+rs.getString(2)+" Depuis : "+rs.getDate(3)+" Jusqu'au "+rs.getDate(4));
            System.out.println("----------------");
        }
       
        
       
        
      
        
        
          
        
     
    }
         
}
